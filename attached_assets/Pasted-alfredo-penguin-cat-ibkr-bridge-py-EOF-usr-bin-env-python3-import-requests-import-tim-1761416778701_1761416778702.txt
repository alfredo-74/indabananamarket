alfredo@penguin:~$ cat > ~/ibkr_bridge.py << 'EOF'
#!/usr/bin/env python3
import requests
import time
from datetime import datetime
from ib_insync import IB, Future, util

class SimpleBridge:
    def __init__(self, replit_url):
        self.replit_url = replit_url
        self.ib = IB()
        self.es_contract = None
        
    def connect(self):
        try:
            print("Connecting to IB Gateway on localhost:4002...")
            self.ib.connect('127.0.0.1', 4002, clientId=1)
            self.ib.reqMarketDataType(3)
            print("âœ“ Connected to IB Gateway (PAPER)")
            
            account_values = self.ib.accountSummary()
            balance = 0
            for item in account_values:
                if item.tag == 'NetLiquidation':
                    balance = float(item.value)
                    print(f"âœ“ Account Balance: ${balance:,.2f}")
            
            self.send_to_replit({"type": "connection", "connected": True, "account_balance": balance})
            return True
        except Exception as e:
            print(f"âœ— Connection failed: {e}")
            return False
    
    def setup_es_contract(self):
        try:
            print("\nðŸ” Finding ES contract...")
            es = Future(symbol='ES', exchange='CME')
            contracts = self.ib.reqContractDetails(es)
            if not contracts:
                print("âœ— No ES contracts found")
                return False
            sorted_contracts = sorted(contracts, key=lambda c: c.contract.lastTradeDateOrContractMonth)
            self.es_contract = sorted_contracts[0].contract
            print(f"âœ“ Using {self.es_contract.localSymbol}")
            self.ib.reqMktData(self.es_contract, '', False, False)
            print("âœ“ Subscribed to ES market data")
            return True
        except Exception as e:
            print(f"âœ— ES contract setup failed: {e}")
            return False
python3 ~/ibkr_bridge.pye(url)p"):it URL: ").strip()it")lit", end='\r')000)ticker.ask) else ticker.last + 0.25,
============================================================
IBKR Bridge - Connects IB Gateway to Replit
============================================================

Enter your Replit URL: https://bananamarket.replit.app
Connecting to IB Gateway on localhost:4002...
âœ“ Connected to IB Gateway (PAPER)
âœ“ Account Balance: $2,193.78

ðŸ” Finding ES contract...
âœ“ Using ESZ5
âœ“ Subscribed to ES market data

ðŸ“Š Streaming live data to Replit...
